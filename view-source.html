
<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>客户端构建器</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<style>
body {
font-family: 'Roboto', "Microsoft YaHei", "PingFang SC", "Hiragino Sans GB", "Noto Sans CJK SC", sans-serif;
background-color: #000;
color: #e0e0e0;
margin: 0;
padding: 20px;
}
.platform {
display: grid;
grid-template-columns: 1fr;
grid-gap: 20px;
margin: 0 auto;
padding: 20px;
max-width: 1200px;
}
.container {
display: grid;
grid-template-columns: 1fr 1fr;
grid-gap: 20px;
margin: 0 auto;
padding: 20px;
max-width: 1200px;
}
.column {
flex: 50%;
}
h1 {
color: #fff;
text-align: center;
grid-column: 1 / -1;
}
h2 {
color: #fff;
margin-top: 0;
}
.section {
background-color: #111;
border-radius: 8px;
padding: 20px;
box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
flex: 50%;
}
label {
display: block;
margin-bottom: 5px;
color: #bbb;
}
input[type="text"], input[type="password"], select, textarea {
width: 100%;
padding: 8px;
margin-bottom: 10px;
background-color: #222;
border: 1px solid #444;
border-radius: 4px;
color: #fff;
}
.form-check {
  display: flex;
  align-items: center;
  gap: 0.5rem; /* 控制间距 */
  margin-bottom: 0.5rem;
}

.form-check input[type="checkbox"],
.form-check input[type="radio"] {
  margin: 0;
  flex-shrink: 0;
}
button {
background-color: #0077ff;
color: #fff;
border: none;
padding: 10px 20px;
border-radius: 4px;
cursor: pointer;
transition: background-color 0.3s ease;
}
button:hover {
background-color: #0066cc;
}
.platform-icons {
display: flex;
justify-content: space-around;
margin-bottom: 20px;
}
.platform-icon {
font-size: 32px;
color: #bbb;
cursor: pointer;
transition: color 0.3s ease;
}
.platform-icon:hover, .platform-icon.active {
color: #2e52f7;
}
.text-64 {
font-size: 0.5em;
font-weight: bold;
bottom: -0.2em;
right: -0.2em;
position: absolute;
color: white;
transform: translate(-50%, -50%);
}
.text-32 {
font-size: 0.5em;
font-weight: bold;
bottom: -0.2em;
right: -0.2em;
position: absolute;
color: white;
transform: translate(-50%, -50%);
}
.checkbox-group {
display: grid;
grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
gap: 10px;
}
.checkbox-group label {
display: flex;
align-items: center;
}
.preview-image {
max-width: 100%;
max-height: 100px;
margin-top: 10px;
}
.save-load-section-container {
position: fixed;
top: 20px;
right: 20px;
background-color: #111;
padding: 0px;
border-radius: 8px;
box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
z-index: 100;
}
.save-load-section {
display: none;
}
.error {
color: red;
}
.errorlist {
color: red;
display: flex;
justify-content: center;
align-items: center;
list-style: none;
padding: 0;
margin: 10px auto;
width: fit-content;
}
.errorlist li {
margin: 5px;
}
@keyframes blink {
0% { opacity: 1; }
50% { opacity: 0.5; }
100% { opacity: 1; }
}
.help-text {
color: #ffd700;
font-style: italic;
animation: blink 2s infinite;
padding: 5px;
border-radius: 4px;
display: inline-block;
margin-left: 10px;
}
.password-requirement {
display: none;
color: orange;
font-size: 0.9em;
margin-top: 5px;
}
.sponsor-button {
display: inline-flex;
align-items: center;
background: linear-gradient(135deg, #00457C 0%, #0079C1 100%);
color: white;
padding: 12px 28px;
border-radius: 50px;
text-decoration: none;
font-weight: 600;
font-size: 16px;
letter-spacing: 0.5px;
transition: all 0.3s ease;
box-shadow: 0 4px 15px rgba(0, 69, 124, 0.2);
border: 2px solid rgba(255, 255, 255, 0.1);
text-transform: uppercase;
}
.sponsor-button:hover {
transform: translateY(-2px);
box-shadow: 0 8px 25px rgba(0, 69, 124, 0.3);
background: linear-gradient(135deg, #005AA7 0%, #0095EA 100%);
border-color: rgba(255, 255, 255, 0.2);
}
.sponsor-button i {
margin-right: 12px;
font-size: 20px;
background: white;
color: #00457C;
padding: 8px;
border-radius: 50%;
width: 20px;
height: 20px;
display: flex;
align-items: center;
justify-content: center;
transition: all 0.3s ease;
}
.sponsor-button:hover i {
transform: rotate(360deg);
color: #0095EA;
}
</style>
</head>
<body>
<h1><i class="fas fa-cogs"></i> 客户端构建器</h1>
<form id="myForm" action="/generator" method="post" enctype="multipart/form-data">
<input type="hidden" name="csrfmiddlewaretoken" value="8frSyBH8ONZgK8kLLwHc0DptBLy6cpPA42QLQSjVuzm9KogbvYHbaptNiNaQzgk6">

  <!-- 保存/加载配置 -->
  <div class="save-load-section-container mb-4">
    <div class="card bg-dark text-light border-secondary shadow-sm">
      <div class="card-header bg-secondary text-white d-flex align-items-center">
        <i class="fas fa-save me-2"></i> 保存/加载配置
      </div>
      <div class="card-body">
        <button type="button" onclick="saveFormData()" class="btn btn-outline-primary me-2">保存配置</button>
        <input type="file" id="fileInput" style="display:none;" accept=".json">
        <button type="button" onclick="loadFormData()" class="btn btn-outline-success">加载配置</button>
      </div>
    </div>
  </div>

  <!-- 平台选择 -->
  <div class="card bg-dark text-light border-secondary shadow-sm mb-4">
    <div class="card-header bg-secondary text-white d-flex align-items-center">
      <i class="fas fa-desktop me-2"></i> 选择平台
    </div>
    <div class="card-body">
      <div class="platform-icons mb-3">
        <span class="fa-stack fa-lg me-2">
          <i class="fab fa-windows fa-stack-2x platform-icon active" data-platform="windows"></i>
          <strong class="fa-stack-1x text-64">64</strong>
        </span>
        <span class="fa-stack fa-lg me-2">
          <i class="fab fa-windows fa-stack-2x platform-icon" data-platform="windows-x86"></i>
          <strong class="fa-stack-1x text-32">32</strong>
        </span>
        <i class="fab fa-linux platform-icon me-2" data-platform="linux"></i>
        <i class="fab fa-android platform-icon me-2" data-platform="android"></i>
        <i class="fab fa-apple platform-icon" data-platform="macos"></i>
      </div>
      <select name="platform" id="id_platform" class="form-select bg-secondary text-light mb-3">
        <option value="windows" selected>Windows 64 位</option>
        <option value="windows-x86">Windows 32 位</option>
        <option value="linux">Linux</option>
        <option value="android">Android</option>
        <option value="macos">macOS</option>
      </select>
        <div class="mb-3">
          <label for="id_version" class="form-label">版本号：</label>
          <select name="version" id="id_version">
  <option value="master">master</option>

  <option value="1.4.5" selected>1.4.5</option>

  <option value="1.4.4">1.4.4</option>

  <option value="1.4.3">1.4.3</option>

  <option value="1.4.2">1.4.2</option>

  <option value="1.4.1">1.4.1</option>

  <option value="1.4.0">1.4.0</option>

  <option value="1.3.9">1.3.9</option>

  <option value="1.3.8">1.3.8</option>

  <option value="1.3.7">1.3.7</option>

  <option value="1.3.6">1.3.6</option>

  <option value="1.3.5">1.3.5</option>

  <option value="1.3.4">1.3.4</option>

  <option value="1.3.3">1.3.3</option>

</select>
          <div class="form-text"></div>
        </div>
        <div class="mb-3 form-check">
          <input type="checkbox" name="ui_mode" id="id_ui_mode" checked>
          <label class="form-check-label" for="id_ui_mode">
            启用定制版用户界面
          </label>
        </div>
        <div class="mb-3">
          <div class="form-text text-warning mt-2">
            <i class="fas fa-exclamation-triangle me-1"></i>
            客户端构建器的部分功能，均以 Windows 64 位系统为基准进行适配，无法确保在其他操作系统正常生效, 预设密码仅允许软件安装后使用
          </div>
        </div>
    </div>
  </div>


<!-- 第一行：通用设置 & 服务器配置 -->
<div class="row g-4 mb-4">
  <!-- 通用设置 -->
  <div class="col-lg-6">
    <div class="card bg-dark text-light border-secondary shadow-sm h-100">
      <div class="card-header bg-secondary text-white d-flex align-items-center">
        <i class="fas fa-sliders-h me-2"></i> 通用设置
      </div>
      <div class="card-body">
        <div class="mb-3">
          <label for="id_exename" class="form-label">配置名称（仅限英文字符）：</label>
          <input type="text" name="exename" required id="id_exename">
          <div id="filenameError" class="text-danger small"></div>
        </div>
        <div class="mb-3">
          <label for="id_appname" class="form-label">应用名称：</label>
          <input type="text" name="appname" id="id_appname">
        </div>
        <div class="mb-3">
          <label for="id_androidappid" class="form-label">安卓客户端标识符(默认'com.carriez.flutter_hbb')</label>
          <input type="text" name="androidappid" id="id_androidappid">
        </div>
        <div class="mb-3">
          <label for="" class="form-label">客户端类型：</label>
          <div id="id_direction"><div>
    <label for="id_direction_0"><input type="radio" name="direction" value="incoming" required id="id_direction_0" checked>
 仅被控</label>

</div><div>
    <label for="id_direction_1"><input type="radio" name="direction" value="outgoing" required id="id_direction_1">
 仅主控</label>

</div><div>
    <label for="id_direction_2"><input type="radio" name="direction" value="both" required id="id_direction_2">
 双向控制</label>

</div>
</div>
        </div>
        <div class="mb-3">
          <label for="id_installation" class="form-label">安装行为：</label>
          <select name="installation" id="id_installation">
  <option value="installationY" selected>否，启用安装</option>

  <option value="installationN">是，禁用安装</option>

</select>
          <small class="form-text text-muted">* 禁止安装 = 用户无法安装</small>
        </div>
        <div class="mb-3">
          <label for="id_settings" class="form-label">设置权限：</label>
          <select name="settings" id="id_settings">
  <option value="settingsY" selected>否，启用设置</option>

  <option value="settingsN">是，禁用设置</option>

</select>
        </div>
      </div>
    </div>
  </div>

  <!-- 服务器配置 -->
  <div class="col-lg-6">
    <div class="card bg-dark text-light border-secondary shadow-sm h-100">
      <div class="card-header bg-secondary text-white d-flex align-items-center">
        <i class="fas fa-server me-2"></i> 服务器配置
      </div>
      <div class="card-body">
        <div class="mb-3">
          <label for="id_serverIP" class="form-label">服务器地址：</label>
          <input type="text" name="serverIP" id="id_serverIP">
        </div>
        <div class="mb-3">
          <label for="id_RS_PUB_KEY" class="form-label">密钥：</label>
          <input type="text" name="RS_PUB_KEY" id="id_RS_PUB_KEY">
        </div>
        <div class="mb-3">
          <label for="id_apiServer" class="form-label">API 地址：</label>
          <input type="text" name="apiServer" id="id_apiServer">
        </div>
        <div class="mb-3">
          <label for="id_urlLink" class="form-label">门户网站：</label>
          <input type="text" name="urlLink" id="id_urlLink">
        </div>
        <div class="mb-3">
          <label for="id_downloadLink" class="form-label">更新下载链接：</label>
          <input type="text" name="downloadLink" id="id_downloadLink">
        </div>
        <div class="mb-3">
          <label for="id_updateLink" class="form-label">在线更新链接：</label>
          <input type="text" name="updateLink" id="id_updateLink">
        </div>
        <div class="mb-3">
          <label for="id_compname" class="form-label">公司名称：</label>
          <input type="text" name="compname" id="id_compname">
        </div>
      </div>
    </div>
  </div>
</div>

<!-- 第二行：安全设置 & 外观设置 -->
<div class="row g-4 mb-4">
  <!-- 安全设置 -->
  <div class="col-lg-6">
    <div class="card bg-dark text-light border-secondary shadow-sm h-100">
      <div class="card-header bg-secondary text-white d-flex align-items-center">
        <i class="fas fa-shield-alt me-2"></i> 安全设置
      </div>
      <div class="card-body">
        <div class="mb-3">
          <label for="id_passApproveMode" class="form-label">认证方式：</label>
          <select name="passApproveMode" id="id_passApproveMode">
  <option value="password">通过密码接受会话</option>

  <option value="click">通过点击接受会话</option>

  <option value="password-click" selected>两者均可</option>

</select>
        </div>
        <div class="mb-3">
          <label for="id_permanentPassword" class="form-label">预设密码：</label>
          <input type="password" name="permanentPassword" id="id_permanentPassword">
        </div>
        <div class="mb-3">
        <label for="id_unlockPin" class="form-label">配置PIN：</label>
        <input type="password" name="unlockPin" id="id_unlockPin">
        </div>

        <!-- 多列复选框：安全与界面设置（三列） -->
        <div class="row g-2">
          <div class="col-md-6 col-lg-4">
            <div class="form-check">
              <input type="checkbox" name="denyLan" id="id_denyLan" checked>
              <label for="id_denyLan" class="form-check-label">隐藏于局域网</label>
            </div>
          </div>
          <div class="col-md-6 col-lg-4">
            <div class="form-check">
              <input type="checkbox" name="enableDirectIP" id="id_enableDirectIP" checked>
              <label for="id_enableDirectIP" class="form-check-label">启用IP访问</label>
            </div>
          </div>
          <div class="col-md-6 col-lg-4">
            <div class="form-check">
              <input type="checkbox" name="autoClose" id="id_autoClose" checked>
              <label for="id_autoClose" class="form-check-label">自动关闭会话</label>
            </div>
          </div>
          <div class="col-md-6 col-lg-4">
            <div class="form-check">
              <input type="checkbox" name="hideSecuritySettings" id="id_hideSecuritySettings">
              <label for="id_hideSecuritySettings" class="form-check-label">隐藏安全设置</label>
            </div>
          </div>
          <div class="col-md-6 col-lg-4">
            <div class="form-check">
              <input type="checkbox" name="hideNetworkSettings" id="id_hideNetworkSettings">
              <label for="id_hideNetworkSettings" class="form-check-label">隐藏网络设置</label>
            </div>
          </div>
          <div class="col-md-6 col-lg-4">
            <div class="form-check">
              <input type="checkbox" name="hideServerSettings" id="id_hideServerSettings">
              <label for="id_hideServerSettings" class="form-check-label">隐藏服务器设置</label>
            </div>
          </div>
          <div class="col-md-6 col-lg-4">
            <div class="form-check">
              <input type="checkbox" name="hideRemotePrinterSettings" id="id_hideRemotePrinterSettings">
              <label for="id_hideRemotePrinterSettings" class="form-check-label">隐藏远程打印设置</label>
            </div>
          </div>
          <div class="col-md-6 col-lg-4">
            <div class="form-check">
              <input type="checkbox" name="hide_account" id="id_hide_account">
              <label for="id_hide_account" class="form-check-label">隐藏账户设置</label>
            </div>
          </div>
          <div class="col-md-6 col-lg-4">
            <div class="form-check">
              <input type="checkbox" name="remove_preset_password_warning" id="id_remove_preset_password_warning" checked>
              <label for="id_remove_preset_password_warning" class="form-check-label">隐藏密码警告</label>
            </div>
          </div>
          <div class="col-md-6 col-lg-4">
            <div class="form-check">
              <input type="checkbox" name="hideProxySettings" id="id_hideProxySettings">
              <label for="id_hideProxySettings" class="form-check-label">隐藏代理设置</label>
            </div>
          </div>
          <div class="col-md-6 col-lg-4">
            <div class="form-check">
              <input type="checkbox" name="hideWebsocketSettings" id="id_hideWebsocketSettings">
              <label for="id_hideWebsocketSettings" class="form-check-label">隐藏 WebSocket 设置</label>
            </div>
          </div>
          <div class="col-md-6 col-lg-4">
            <div class="form-check">
              <input type="checkbox" name="hidecm" id="id_hidecm">
              <label for="id_hidecm" class="form-check-label">隐藏连接管理窗口</label>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- 外观设置 -->
  <div class="col-lg-6">
    <div class="card bg-dark text-light border-secondary shadow-sm h-100">
      <div class="card-header bg-secondary text-white d-flex align-items-center">
        <i class="fas fa-paint-brush me-2"></i> 外观设置
      </div>
      <div class="card-body">
        
        
        
        <div class="row g-3 mb-3">
          <div class="col-md-6">
            <label for="id_iconfile" class="form-label">应用图标（PNG 格式）：</label>
            <input type="file" name="iconfile" accept="image/png" id="id_iconfile">
            <div id="icon-preview" class="mt-2"></div>
          </div>
    
          <div class="col-md-6">
            <label for="id_logofile" class="form-label">品牌标识（PNG 格式）：</label>
            <input type="file" name="logofile" accept="image/png" id="id_logofile">
            <div id="logo-preview" class="mt-2"></div>
          </div>
        </div>
        <div class="row g-3 mb-3">
          <div class="col-md-12">
            <label for="id_privacy_wallpaper" class="form-label">
              隐私模式背景图（PNG 格式）：
            </label>
              <input type="file" name="privacy_wallpaper" accept="image/png" id="id_privacy_wallpaper">
            <div class="form-text text-warning mt-2">
            <i class="fas fa-exclamation-triangle me-1"></i>
            *上传的图片大小均不得超过500KB,隐私背景图优选1920×1080规格的图片
          </div>
            <div id="privacy-wallpaper-preview" class="mt-2"></div>
          </div>
        </div>
      
        <div class="mb-3">
          <label for="id_theme" class="form-label">主题：</label>
          <select name="theme" id="id_theme">
  <option value="light">浅色主题</option>

  <option value="dark">深色主题</option>

  <option value="system" selected>跟随系统</option>

</select> <select name="themeDorO" id="id_themeDorO">
  <option value="default" selected>默认设置</option>

  <option value="override">强制覆盖</option>

</select>
       <div class="mb-3">
          <label for="id_image_quality">图像质量:</label>
          <select name="image_quality" id="id_image_quality">
  <option value="best"> 最佳</option>

  <option value="balanced" selected>平衡</option>

  <option value="low">低</option>

  <option value="custom">自定义</option>

</select>
     </div>

       <div class="mb-3">
         <label for="id_custom_fps">自定义帧率:</label>
         <select name="custom_fps" id="id_custom_fps">
  <option value="30" selected>30 FPS</option>

  <option value="60">60 FPS</option>

  <option value="90">90 FPS</option>

  <option value="120">120 FPS</option>

</select>
  </div>

        </div>
      </div>
    </div>
  </div>
</div>

<!-- 第三行：权限控制 & 高级设置 -->
<div class="row g-4 mb-4">
 <!-- 权限控制 -->
<div class="col-lg-6">
  <div class="card bg-dark text-light border-secondary shadow-sm h-100">
    <div class="card-header bg-secondary text-white d-flex align-items-center">
      <i class="fas fa-lock me-2"></i> 权限控制
    </div>
    <div class="card-body">
      <div class="mb-3">
        <label for="id_permissionsType" class="form-label">权限预设：</label>
        <select name="permissionsType" id="id_permissionsType">
  <option value="custom" selected>自定义</option>

  <option value="full">完全访问</option>

  <option value="view">仅共享屏幕</option>

</select>
      </div>

        <!-- 多列复选框：权限控制（三列） -->
        <div class="row g-2">
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
              <div class="col-md-6 col-lg-4">
                <div class="form-check">
                  <input type="checkbox" name="enableKeyboard" id="id_enableKeyboard" checked>
                  <label for="id_enableKeyboard" class="form-check-label">启用键盘控制</label>
                </div>
              </div>
            
          
            
              <div class="col-md-6 col-lg-4">
                <div class="form-check">
                  <input type="checkbox" name="enableClipboard" id="id_enableClipboard" checked>
                  <label for="id_enableClipboard" class="form-check-label">启用剪贴板同步</label>
                </div>
              </div>
            
          
            
              <div class="col-md-6 col-lg-4">
                <div class="form-check">
                  <input type="checkbox" name="enableFileTransfer" id="id_enableFileTransfer" checked>
                  <label for="id_enableFileTransfer" class="form-check-label">启用文件传输</label>
                </div>
              </div>
            
          
            
              <div class="col-md-6 col-lg-4">
                <div class="form-check">
                  <input type="checkbox" name="enableAudio" id="id_enableAudio">
                  <label for="id_enableAudio" class="form-check-label">启用音频传输</label>
                </div>
              </div>
            
          
            
              <div class="col-md-6 col-lg-4">
                <div class="form-check">
                  <input type="checkbox" name="enableTCP" id="id_enableTCP" checked>
                  <label for="id_enableTCP" class="form-check-label">启用 TCP 隧道</label>
                </div>
              </div>
            
          
            
              <div class="col-md-6 col-lg-4">
                <div class="form-check">
                  <input type="checkbox" name="enableRemoteRestart" id="id_enableRemoteRestart" checked>
                  <label for="id_enableRemoteRestart" class="form-check-label">启用远程重启</label>
                </div>
              </div>
            
          
            
              <div class="col-md-6 col-lg-4">
                <div class="form-check">
                  <input type="checkbox" name="enableRecording" id="id_enableRecording" checked>
                  <label for="id_enableRecording" class="form-check-label">启用会话录制</label>
                </div>
              </div>
            
          
            
              <div class="col-md-6 col-lg-4">
                <div class="form-check">
                  <input type="checkbox" name="enableBlockingInput" id="id_enableBlockingInput" checked>
                  <label for="id_enableBlockingInput" class="form-check-label">启用输入锁定</label>
                </div>
              </div>
            
          
            
              <div class="col-md-6 col-lg-4">
                <div class="form-check">
                  <input type="checkbox" name="enableRemoteModi" id="id_enableRemoteModi">
                  <label for="id_enableRemoteModi" class="form-check-label">允许远程修改配置</label>
                </div>
              </div>
            
          
            
          
            
              <div class="col-md-6 col-lg-4">
                <div class="form-check">
                  <input type="checkbox" name="enablePrinter" id="id_enablePrinter">
                  <label for="id_enablePrinter" class="form-check-label">启用远程打印</label>
                </div>
              </div>
            
          
            
              <div class="col-md-6 col-lg-4">
                <div class="form-check">
                  <input type="checkbox" name="enableCamera" id="id_enableCamera" checked>
                  <label for="id_enableCamera" class="form-check-label">启用摄像头访问</label>
                </div>
              </div>
            
          
            
              <div class="col-md-6 col-lg-4">
                <div class="form-check">
                  <input type="checkbox" name="enableTerminal" id="id_enableTerminal" checked>
                  <label for="id_enableTerminal" class="form-check-label">启用终端访问</label>
                </div>
              </div>
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
        </div>
      </div>
    </div>
  </div>

  <!-- 高级设置 -->
  <div class="col-lg-6">
    <div class="card bg-dark text-light border-secondary shadow-sm h-100">
      <div class="card-header bg-secondary text-white d-flex align-items-center">
        <i class="fas fa-cog me-2"></i> 高级设置
      </div>
      <div class="card-body">
      <div class="row g-2">
        <div class="col-md-6">
          <div class="form-check">
            <input type="checkbox" name="removeWallpaper" id="id_removeWallpaper">
            <label for="id_removeWallpaper" class="form-check-label">远程会话期间移除桌面壁纸</label>
          </div>
        </div>
        <div class="col-md-6">
          <div class="form-check">
            <input type="checkbox" name="delayFix" id="id_delayFix" checked>
            <label for="id_delayFix" class="form-check-label">修复使用第三方 API 时的连接延迟</label>
          </div>
        </div>
      </div>
        <p class="mb-3">
          <a href="https://rustdesk.com/docs/zh-cn/self-host/client-configuration/advanced-settings/"
             target="_blank"
             rel="noopener noreferrer"
             class="text-primary text-decoration-none small">
              点击此处查看可用的高级设置列表
          </a>
        </p>

<div class="mb-3">
  <label for="id_defaultManual" class="form-label">默认设置（用户可修改）</label>
  <textarea name="defaultManual" cols="40" rows="2" class="form-control auto-resize bg-dark text-light border-secondary" id="id_defaultManual">
</textarea>
</div>

<div class="mb-3">
  <label for="id_overrideManual" class="form-label">覆盖设置（用户不可修改）</label>
  <textarea name="overrideManual" cols="40" rows="2" class="form-control auto-resize bg-dark text-light border-secondary" id="id_overrideManual">
</textarea>
</div>
</div>
</div>
</div>
</div>

<!-- 附加功能 (分为主控端、被控端、公用功能) -->
<div class="card bg-dark text-light border-secondary shadow-sm mb-4">
  <div class="card-header bg-secondary text-white d-flex align-items-center">
    <i class="fas fa-code me-2"></i> 附加功能
  </div>
  <div class="card-body">

    <!-- 主控端功能 -->
    <div class="mb-4">
      <h6 class="text-white fw-bold mb-2">
        <i class="fas fa-desktop text-primary me-1"></i> 主控端功能
      </h6>
      <div class="row g-2">
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
            <div class="col-md-6 col-lg-4 col-xl-3">
              <div class="form-check">
                <input type="checkbox" name="cycleMonitor" id="id_cycleMonitor">
                <label for="id_cycleMonitor" class="form-check-label">在会话顶部显示显示器切换按钮</label>
              </div>
            </div>
          
        
          
            <div class="col-md-6 col-lg-4 col-xl-3">
              <div class="form-check">
                <input type="checkbox" name="xOffline" id="id_xOffline">
                <label for="id_xOffline" class="form-check-label">在地址簿中标记离线设备</label>
              </div>
            </div>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
            <div class="col-md-6 col-lg-4 col-xl-3">
              <div class="form-check">
                <input type="checkbox" name="hide_chat_voice" id="id_hide_chat_voice">
                <label for="id_hide_chat_voice" class="form-check-label">隐藏会话中的聊天与语音功能</label>
              </div>
            </div>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
            <div class="col-md-6 col-lg-4 col-xl-3">
              <div class="form-check">
                <input type="checkbox" name="viewOnly" id="id_viewOnly">
                <label for="id_viewOnly" class="form-check-label">默认以浏览模式连接会话</label>
              </div>
            </div>
          
        
          
        
          
            <div class="col-md-6 col-lg-4 col-xl-3">
              <div class="form-check">
                <input type="checkbox" name="collapse_toolbar" id="id_collapse_toolbar">
                <label for="id_collapse_toolbar" class="form-check-label">会话启动时自动折叠工具栏</label>
              </div>
            </div>
          
        
          
            <div class="col-md-6 col-lg-4 col-xl-3">
              <div class="form-check">
                <input type="checkbox" name="privacy_mode" id="id_privacy_mode">
                <label for="id_privacy_mode" class="form-check-label">默认进入隐私模式</label>
              </div>
            </div>
          
        
          
        
          
            <div class="col-md-6 col-lg-4 col-xl-3">
              <div class="form-check">
                <input type="checkbox" name="hide_username_on_card" id="id_hide_username_on_card">
                <label for="id_hide_username_on_card" class="form-check-label">在连接卡片中隐藏用户名</label>
              </div>
            </div>
          
        
          
        
          
        
          
        
          
        
      </div>
    </div>

    <!-- 被控端功能 -->
    <div class="mb-4">
      <h6 class="text-white fw-bold mb-2">
        <i class="fas fa-laptop text-success me-1"></i> 被控端功能
      </h6>
      <div class="row g-2">
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
            <div class="col-md-6 col-lg-4 col-xl-3">
              <div class="form-check">
                <input type="checkbox" name="hideTray" id="id_hideTray">
                <label for="id_hideTray" class="form-check-label">隐藏托盘图标</label>
              </div>
            </div>
          
        
          
        
          
        
          
        
          
            <div class="col-md-6 col-lg-4 col-xl-3">
              <div class="form-check">
                <input type="checkbox" name="hidePassword" id="id_hidePassword">
                <label for="id_hidePassword" class="form-check-label">隐藏临时密码面板</label>
              </div>
            </div>
          
        
          
            <div class="col-md-6 col-lg-4 col-xl-3">
              <div class="form-check">
                <input type="checkbox" name="hideMenuBar" id="id_hideMenuBar">
                <label for="id_hideMenuBar" class="form-check-label">隐藏设置菜单</label>
              </div>
            </div>
          
        
          
            <div class="col-md-6 col-lg-4 col-xl-3">
              <div class="form-check">
                <input type="checkbox" name="hideQuit" id="id_hideQuit">
                <label for="id_hideQuit" class="form-check-label">隐藏退出按钮</label>
              </div>
            </div>
          
        
          
            <div class="col-md-6 col-lg-4 col-xl-3">
              <div class="form-check">
                <input type="checkbox" name="addcopy" id="id_addcopy">
                <label for="id_addcopy" class="form-check-label">添加复制按钮</label>
              </div>
            </div>
          
        
          
            <div class="col-md-6 col-lg-4 col-xl-3">
              <div class="form-check">
                <input type="checkbox" name="applyprivacy" id="id_applyprivacy">
                <label for="id_applyprivacy" class="form-check-label">禁止被控端退出隐私模式</label>
              </div>
            </div>
          
        
          
        
          
        
          
            <div class="col-md-6 col-lg-4 col-xl-3">
              <div class="form-check">
                <input type="checkbox" name="passpolicy" id="id_passpolicy">
                <label for="id_passpolicy" class="form-check-label">允许使用简单的临时密码</label>
              </div>
            </div>
          
        
          
        
          
        
          
        
          
            <div class="col-md-6 col-lg-4 col-xl-3">
              <div class="form-check">
                <input type="checkbox" name="allowHostnameAsId" id="id_allowHostnameAsId">
                <label for="id_allowHostnameAsId" class="form-check-label">使用主机名作为 ID（Windows 10 及以上）</label>
              </div>
            </div>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
            <div class="col-md-6 col-lg-4 col-xl-3">
              <div class="form-check">
                <input type="checkbox" name="hideService_Start_Stop" id="id_hideService_Start_Stop">
                <label for="id_hideService_Start_Stop" class="form-check-label">隐藏常规和托盘的服务启停</label>
              </div>
            </div>
          
        
      </div>
    </div>

    <!-- 通用功能 -->
    <div class="mb-4">
      <h6 class="text-white fw-bold mb-2">
        <i class="fas fa-share-alt text-info me-1"></i> 通用功能
      </h6>
      <div class="row g-2">
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
            <div class="col-md-6 col-lg-4 col-xl-3">
              <div class="form-check">
                <input type="checkbox" name="disable_check_update" id="id_disable_check_update" checked>
                <label for="id_disable_check_update" class="form-check-label">禁用启动时检查更新</label>
              </div>
            </div>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
            <div class="col-md-6 col-lg-4 col-xl-3">
              <div class="form-check">
                <input type="checkbox" name="no_uninstall" id="id_no_uninstall">
                <label for="id_no_uninstall" class="form-check-label">不创建卸载快捷方式</label>
              </div>
            </div>
          
        
          
            <div class="col-md-6 col-lg-4 col-xl-3">
              <div class="form-check">
                <input type="checkbox" name="disable_install" id="id_disable_install">
                <label for="id_disable_install" class="form-check-label">生成便携版</label>
              </div>
            </div>
          
        
          
            <div class="col-md-6 col-lg-4 col-xl-3">
              <div class="form-check">
                <input type="checkbox" name="allowD3dRender" id="id_allowD3dRender">
                <label for="id_allowD3dRender" class="form-check-label">启用 Direct3D 渲染</label>
              </div>
            </div>
          
        
          
        
          
        
          
            <div class="col-md-6 col-lg-4 col-xl-3">
              <div class="form-check">
                <input type="checkbox" name="use_texture_render" id="id_use_texture_render">
                <label for="id_use_texture_render" class="form-check-label">启用纹理渲染（Windows 10 及以上）</label>
              </div>
            </div>
          
        
          
        
          
        
          
            <div class="col-md-6 col-lg-4 col-xl-3">
              <div class="form-check">
                <input type="checkbox" name="pre_elevate_service" id="id_pre_elevate_service">
                <label for="id_pre_elevate_service" class="form-check-label">启动时自动提权</label>
              </div>
            </div>
          
        
          
        
          
            <div class="col-md-6 col-lg-4 col-xl-3">
              <div class="form-check">
                <input type="checkbox" name="sync_init_clipboard" id="id_sync_init_clipboard">
                <label for="id_sync_init_clipboard" class="form-check-label">同步初始剪贴板内容</label>
              </div>
            </div>
          
        
          
            <div class="col-md-6 col-lg-4 col-xl-3">
              <div class="form-check">
                <input type="checkbox" name="hide_powered_by_me" id="id_hide_powered_by_me" checked>
                <label for="id_hide_powered_by_me" class="form-check-label">隐藏“技术支持”标识</label>
              </div>
            </div>
          
        
          
        
          
        
      </div>
    </div>

  </div>
</div>

  
  <!-- 提交按钮 -->
  <div class="d-grid">
    <button type="submit" class="btn btn-primary btn-lg px-5 py-3 shadow">
      <i class="fas fa-rocket me-2"></i>牛马开始干活
    </button>
  </div>

</form>

<script>
document.addEventListener('DOMContentLoaded', function () {
    const fpsSelect = document.getElementById('id_custom_fps');
    const qualitySelect = document.getElementById('id_image_quality');

    if (!fpsSelect || !qualitySelect) return;

    const enforceCustomOnHighFPS = () => {
        const fps = parseInt(fpsSelect.value);
        if ([60, 90, 120].includes(fps)) {
            qualitySelect.value = 'custom';
        }
    };

    enforceCustomOnHighFPS(); 
    fpsSelect.addEventListener('change', enforceCustomOnHighFPS);
});
</script>

<script>
document.querySelectorAll('.platform-icon').forEach(icon => {
icon.addEventListener('click', function() {
document.querySelectorAll('.platform-icon').forEach(i => i.classList.remove('active'));
this.classList.add('active');
document.getElementById('id_platform').value = this.dataset.platform;
});
});

document.getElementById("id_iconfile").addEventListener('change', function(event) {
previewImage(event.target, 'icon-preview');
});
document.getElementById("id_logofile").addEventListener('change', function(event) {
previewImage(event.target, 'logo-preview');
});

document.getElementById("id_hidecm").addEventListener('change', function() {
if (this.checked) {
document.getElementById("passwordRequirement").style.display = 'block';
document.getElementById("id_permanentPassword").focus();
document.getElementById("id_passApproveMode").value = 'password';
} else {
document.getElementById("passwordRequirement").style.display = 'none';
document.getElementById("id_passApproveMode").value = 'password-click';
}
});

const enableKeyboard = document.getElementById("id_enableKeyboard");
const enableClipboard = document.getElementById("id_enableClipboard");
const enableFileTransfer = document.getElementById("id_enableFileTransfer");
const enableAudio = document.getElementById("id_enableAudio");
const enableTCP = document.getElementById("id_enableTCP");
const enableRemoteRestart = document.getElementById("id_enableRemoteRestart");
const enableRecording = document.getElementById("id_enableRecording");
const enableBlockingInput = document.getElementById("id_enableBlockingInput");
const enableRemoteModi = document.getElementById("id_enableRemoteModi");
const enablePrinter = document.getElementById("id_enablePrinter");
const enableCamera = document.getElementById("id_enableCamera");
const enableTerminal = document.getElementById("id_enableTerminal");

document.getElementById("id_permissionsType").addEventListener('change', function() {
if (this.value === 'full') {
[enableKeyboard, enableClipboard, enableFileTransfer, enableAudio, enableTCP,
enableRemoteRestart, enableRecording, enableBlockingInput, enableRemoteModi,
enablePrinter, enableCamera, enableTerminal].forEach(el => {
el.checked = true;
el.disabled = true;
});
} else if (this.value === 'view') {
[enableKeyboard, enableClipboard, enableFileTransfer, enableAudio, enableTCP,
enableRemoteRestart, enableRecording, enableBlockingInput, enableRemoteModi,
enablePrinter, enableCamera, enableTerminal].forEach(el => {
el.checked = false;
el.disabled = true;
});
} else if (this.value === 'custom') {
[enableKeyboard, enableClipboard, enableFileTransfer, enableAudio, enableTCP,
enableRemoteRestart, enableRecording, enableBlockingInput, enableRemoteModi].forEach(el => {
el.disabled = false;
});
enablePrinter.checked = false;
enableCamera.checked = false;
enableTerminal.checked = false;
}
});

function previewImage(input, previewContainerId) {
if (input.files && input.files[0]) {
var reader = new FileReader();
reader.onload = function(e) {
var img = document.createElement('img');
img.src = e.target.result;
img.style.maxWidth = '300px';
img.style.maxHeight = '60px';
document.getElementById(previewContainerId).innerHTML = '';
document.getElementById(previewContainerId).appendChild(img);
};
reader.readAsDataURL(input.files[0]);
}
}

const saveLoadTitle = document.getElementById("saveLoadTitle");
const saveLoadSection = document.querySelector(".save-load-section");
saveLoadTitle.addEventListener("click", () => {
saveLoadSection.style.display = saveLoadSection.style.display === "block" ? "none" : "block";
const icon = saveLoadTitle.querySelector("i");
icon.classList.toggle("fa-chevron-down");
icon.classList.toggle("fa-chevron-up");
});

async function saveFormData() {
const filename = document.getElementById("id_exename").value;
if (!filename) {
document.getElementById("filenameError").textContent = "配置名称不能为空。";
return;
} else {
document.getElementById("filenameError").textContent = "";
}
const formData = {};
const form = document.getElementById("myForm");
const formDataObj = new FormData(form);
formDataObj.forEach((value, key) => {
formData[key] = value;
});
const selectElements = form.querySelectorAll('select');
selectElements.forEach(select => {
formData[select.name] = select.value;
});
const checkboxRadioElements = form.querySelectorAll('input[type="checkbox"], input[type="radio"]');
checkboxRadioElements.forEach(input => {
if (input.name) {
if (input.type === 'radio') {

if (input.checked) {
formData[input.name] = input.value;
}
} else if (input.type === 'checkbox') {
formData[input.name] = input.checked;
}
}
});
const iconPreview = document.getElementById('icon-preview');
if (iconPreview.firstChild && iconPreview.firstChild.src.startsWith('data:image/png;base64')) {
formData.iconfile = iconPreview.firstChild.src;
} else {
const iconFile = document.getElementById("id_iconfile").files[0];
if (iconFile) {
formData.iconfile = await readFileAsBase64(iconFile);
}
}
const logoPreview = document.getElementById('logo-preview');
if (logoPreview.firstChild && logoPreview.firstChild.src.startsWith('data:image/png;base64')) {
formData.logofile = logoPreview.firstChild.src;
} else {
const logoFile = document.getElementById("id_logofile").files[0];
if (logoFile) {
formData.logofile = await readFileAsBase64(logoFile);
}
}
const jsonData = JSON.stringify(formData, null, 2);
const blob = new Blob([jsonData], { type: "application/json" });
const url = URL.createObjectURL(blob);
const a = document.createElement("a");
a.href = url;
a.download = filename + ".json";
document.body.appendChild(a);
a.click();
document.body.removeChild(a);
URL.revokeObjectURL(url);
}

async function readFileAsBase64(file) {
return new Promise((resolve, reject) => {
const reader = new FileReader();
reader.onload = (event) => resolve(event.target.result);
reader.onerror = (error) => reject(error);
reader.readAsDataURL(file);
});
}

function loadFormData() {
const fileInput = document.getElementById("fileInput");
fileInput.click();
fileInput.addEventListener("change", (event) => {
const file = event.target.files[0];
if (file) {
const reader = new FileReader();
reader.onload = (e) => {
try {
const formData = JSON.parse(e.target.result);
for (const key in formData) {
const elements = document.querySelectorAll(`[name="${key}"], [id="${key}"]`);
if (elements.length > 0) {
elements.forEach(element => {
if (element.type === 'radio') {
if (element.value === String(formData[key])) {
element.checked = true;
}
} else if (element.type === 'checkbox') {
element.checked = Boolean(formData[key]);
} else if (element.type !== 'file') {
element.value = formData[key];
}
if (key === 'iconfile' && formData[key]) {
document.getElementById('id_iconbase64').value = formData[key];
document.getElementById('icon-preview').innerHTML = `<img src="${formData[key]}" style="max-width: 300px; max-height: 60px;">`;
}
if (key === 'logofile' && formData[key]) {
document.getElementById('id_logobase64').value = formData[key];
document.getElementById('logo-preview').innerHTML = `<img src="${formData[key]}" style="max-width: 300px; max-height: 60px;">`;
}
});
}
}
} catch (error) {
alert("加载配置失败：无效的 JSON 文件。");
}
};
reader.readAsText(file);
}
});
}
</script>

<script>
document.addEventListener('DOMContentLoaded', function () {
    const uiModeCheckbox = document.getElementById('id_ui_mode');
    const targetFields = [
        'addcopy'
    ].map(name => document.getElementById('id_' + name));

    function toggleDependentCheckboxes() {
        const isEnabled = uiModeCheckbox.checked;
        targetFields.forEach(checkbox => {
            if (checkbox) {
                checkbox.disabled = !isEnabled;
                // 可选：当禁用时自动取消勾选（避免提交无效值）
                if (!isEnabled) {
                    checkbox.checked = false;
                }
            }
        });
    }

    // 初始化状态
    toggleDependentCheckboxes();

    // 监听 ui_mode 变化
    if (uiModeCheckbox) {
        uiModeCheckbox.addEventListener('change', toggleDependentCheckboxes);
    }
});
</script>

<script>
document.addEventListener('DOMContentLoaded', function () {
    // 获取 direction 字段的所有 radio 按钮
    const directionRadios = document.querySelectorAll('[name="direction"]');

    if (!directionRadios.length) {
        console.error(' 未找到 direction 的 radio 按钮');
        return;
    }

    // 要被控制的字段名列表（Django 字段名）
    const dependentFieldNames = [
        'viewOnly',
        'cycleMonitor',
        'xOffline',
        'hide_chat_voice',
        'privacy_mode',
        'collapse_toolbar',
        'hide_username_on_card'
    ];

    const targetFields = dependentFieldNames.map(name =>
        document.getElementById('id_' + name)
    ).filter(el => el !== null); // 过滤掉没找到的

    function toggleDependentFields() {
        // 查找当前是否选择了 "incoming"
        const isIncomingSelected = Array.from(directionRadios).some(radio => {
            return radio.checked && radio.value === 'incoming';
        });

        targetFields.forEach(field => {
            field.disabled = isIncomingSelected;
            if (isIncomingSelected && field.type === 'checkbox') {
                field.checked = false;
            }
        });
    }

    // 初始化状态
    toggleDependentFields();

    // 监听所有 direction radio 的变化
    directionRadios.forEach(radio => {
        radio.addEventListener('change', toggleDependentFields);
    });
});
</script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    const downloadLinkInput = document.getElementById('id_downloadLink');
    const updateLinkInput = document.getElementById('id_updateLink');
    const disableCheckUpdateCheckbox = document.getElementById('id_disable_check_update');

    function isBlank(str) {
        return !str || str.trim() === '';
    }

    function updateDisableCheckUpdateState() {
        if (!disableCheckUpdateCheckbox) return;

        const hasCustomDownload = !isBlank(downloadLinkInput?.value);
        const hasCustomUpdate = !isBlank(updateLinkInput?.value);

        if (hasCustomDownload || hasCustomUpdate) {
            // 用户自定义了任一链接 → 强制不禁用更新
            disableCheckUpdateCheckbox.checked = false;
            disableCheckUpdateCheckbox.disabled = true;
        } else {
            // 都没填 → 允许禁用
            disableCheckUpdateCheckbox.disabled = false;
        }
    }

    // 初始化状态
    updateDisableCheckUpdateState();

    // 监听输入
    downloadLinkInput?.addEventListener('input', updateDisableCheckUpdateState);
    updateLinkInput?.addEventListener('input', updateDisableCheckUpdateState);
});
</script>
</body>
</html>
